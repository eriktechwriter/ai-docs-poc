---
slug: trend-vision-one-malware-scanning
title: Malware Scanning
---
# Malware Scanning

Malware Scanning uses Trend Micro's virus scan engine to detect emerging threats.

**Related information**

- Configuring Malware Scanning

## Configuring Malware Scanning {#configuring-malware-scanning}

### Procedure {#procedure}

1.  Select **Malware Scanning**.

2.  Configure rule settings.

    <table>
    <colgroup>
    <col style="width: 25%" />
    <col style="width: 75%" />
    </colgroup>
    <thead>
    <tr>
    <th><p>Setting</p></th>
    <th><p>Description</p></th>
    </tr>
    </thead>
    <tbody>
    <tr>
    <td><p>Apply to</p></td>
    <td><p>(Exchange Online and Gmail only) Select the scope of email messages that Malware Scanning applies to.</p>
    <ul>
    <li><p><strong>All messages</strong>: means that this policy applies to incoming, outgoing, and internal email messages. Incoming/outgoing email messages are sent from/to non-internal domains.</p></li>
    <li><p><strong>Incoming messages</strong>: means that this policy applies only to incoming email messages sent from non-internal domains.</p></li>
    </ul>


    :::note

    <p>For details about internal domains, see <a href="trend-vision-one-configuring-internal-domain-list">Configuring the internal domain list</a></p>
    <p>For Exchange Online (Inline Mode), the scope is fixed to <strong>Inbound messages</strong> for inbound protection and <strong>Outbound messages</strong> for outbound protection. Inbound messages are sent from outside your organization to an address inside the organization, while outbound messages are sent from your organization to external addresses.</p>


    :::

    </td>
    </tr>
    <tr>
    <td><p>Files to scan</p></td>
    <td><ul>
    <li><p>Scan all files, true file types, or specific file types for malware</p></li>
    <li><p>Select whether to leverage the Predictive Machine Learning engine to detect emerging unknown security risks. For details, see About predictive machine learning.</p>
    <p>For a new policy, this check box is selected by default.</p></li>
    <li><p>(Exchange Online and Gmail only) Select whether to scan the message body.</p></li>
    <li><p>Select whether to enable IntelliTrap.</p>
    <p>IntelliTrap helps reduce the risk of viruses that use real-time compression algorithms to bypass network security by blocking real-time compressed executable files and pairing them with other malware characteristics. Because IntelliTrap identifies such files as security risks and may incorrectly block safe files, consider quarantining (not deleting) files after enabling IntelliTrap.</p></li>
    <li><p>Select whether to let Trend Micro collect suspicious file information to improve the detection capabilities of the Advanced Threat Scan Engine and the Predictive Machine Learning engine.</p>


    :::note

    <p>If you enable this option, Trend Micro only checks potentially risky files and encrypts all content before transferring any information.</p>


    :::


    <p>For a new policy, this check box is selected by default.</p></li>
    </ul></td>
    </tr>
    <tr>
    <td><p>Enable Predictive Machine Learning</p></td>
    <td><p>Select whether to leverage the Predictive Machine Learning engine to detect emerging unknown security risks. For details, see About predictive machine learning.</p>
    <p>For a new policy, this check box is selected by default.</p></td>
    </tr>
    <tr>
    <td><p>Scan message body</p></td>
    <td><p>(Exchange Online and Gmail only) Select whether to scan the message body.</p></td>
    </tr>
    <tr>
    <td><p>Enable IntelliTrap</p></td>
    <td><p>Select whether to enable IntelliTrap.</p>
    <p>IntelliTrap helps reduce the risk of viruses that use real-time compression algorithms to bypass network security by blocking real-time compressed executable files and pairing them with other malware characteristics. Because IntelliTrap identifies such files as security risks and may incorrectly block safe files, consider quarantining (not deleting) files after enabling IntelliTrap.</p></td>
    </tr>
    <tr>
    <td><p>Allow Trend Micro to collect suspicious file information to improve its detection capabilities</p></td>
    <td><p>Select whether to let Trend Micro collect suspicious file information to improve the detection capabilities of the Advanced Threat Scan Engine and the Predictive Machine Learning engine.</p>


    :::note

    <p>If you enable this option, Trend Micro only checks potentially risky files and encrypts all content before transferring any information.</p>


    :::


    <p>For a new policy, this check box is selected by default.</p></td>
    </tr>
    <tr>
    <td><p>Detect active content in supported formats of files</p></td>
    <td><p>(Exchange Online, Exchange Online (Inline Mode) only) Select whether to enable and configure actions specifically for email messages that contain active content such as macros in attached files.</p>


    :::note

    <p>Currently supported file formats include Microsoft Office documents and PDF files.</p>


    :::


    <p>When detecting the presence of supported active content, whether it is malicious, Cloud Email and Collaboration Protection takes the configured action.</p>
    <p>This option applies to uncompressed files in received email messages from external and internal senders.</p>
    <p>In the <strong>Action</strong> section, you can configure to sanitize the attached file or pass, quarantine, or delete the entire email message upon detection of active content. If <strong>Sanitize file</strong> is selected, Cloud Email and Collaboration Protection removes the active content from the file and delivers the email message with the sanitized file.</p>


    :::note

    <p>The email message will still go through the other security filters in the same policy.</p>
    <p>If Cloud Email and Collaboration Protection fails to remove the active content, it will take the <strong>Pass</strong> action, that is, to deliver the email message with the original file to the intended recipient.</p>


    :::

    </td>
    </tr>
    </tbody>
    </table>

3.  Click **Action & Notifications**.

4.  Configure **Action** settings.

    Cloud Email and Collaboration Protection protects cloud applications and services by executing specified actions after detecting a file that matches scanning conditions. The action depends on the performed scan, the affected application or service, and the configured actions for that scan.

    - Exchange Online, Exchange Online (Inline Mode) - Inbound Protection, Exchange Online (Inline Mode) - Outbound Protection policies

    ::: {.simpletable-container}
    <table id="GUID-3E119A85-CEE9-4732-962D-DC621E3E3762__CHOICETABLE_RRY_2M1_1Q" class="choicetable" data-border="1">
    <colgroup>
    <col style="width: 50%" />
    <col style="width: 50%" />
    </colgroup>
    <thead>
    <tr class="chhead table-header-style">
    <th class="choptionhd">Option</th>
    <th class="chdeschd">Description</th>
    </tr>
    </thead>
    <tbody>
    <tr class="chrow">
    <td class="choption"><p>Action</p></td>
    <td class="chdesc"><p>For details about the actions, see <a href="trend-vision-one-actions-different-services">Actions available for different services</a>.</p></td>
    </tr>
    <tr class="chrow">
    <td class="choption"><p>Advanced Options</p></td>
    <td class="chdesc"><p>Specify the <strong>Replacement file name</strong> and <strong>Replacement text</strong> that Cloud Email and Collaboration Protection uses when an unscannable message arrives. Cloud Email and Collaboration Protection replaces the file/text with the configured replacement information.</p></td>
    </tr>
    <tr class="chrow">
    <td class="choption"><p>Unscannable File Options</p></td>
    <td class="chdesc"><p>Select actions for password-protected files. Specify replacement text that replaces a file/text for an unscannable message.</p>
    <p>When an email message with password-protected attachments arrives, if <a href="trend-vision-one-password-guessing-attachment">Attachment Password Guessing</a> is enabled, Cloud Email and Collaboration Protection first attempts to find passwords in the message to decrypt the attachments for scanning. If no password is found or Attachment Password Guessing is not enabled, Cloud Email and Collaboration Protection treats the attachments as unscannable and perform the action for <strong>Password-protected compressed files</strong> or <strong>Other password-protected files</strong>, depending on whether the attachments are compressed.</p></td>
    </tr>
    </tbody>
    </table>
    :::

    - Gmail policies

    ::: {.simpletable-container}
    <table id="GUID-3E119A85-CEE9-4732-962D-DC621E3E3762__choicetable_bn1_mqr_bhb" class="choicetable" data-border="1">
    <colgroup>
    <col style="width: 50%" />
    <col style="width: 50%" />
    </colgroup>
    <thead>
    <tr class="chhead table-header-style">
    <th class="choptionhd">Option</th>
    <th class="chdeschd">Description</th>
    </tr>
    </thead>
    <tbody>
    <tr class="chrow">
    <td class="choption"><p>Action</p></td>
    <td class="chdesc"><p>For details about the actions, see <a href="trend-vision-one-actions-different-services">Actions available for different services</a>.</p></td>
    </tr>
    <tr class="chrow">
    <td class="choption"><p>Unscannable File Options</p></td>
    <td class="chdesc"><p>Select actions for password-protected files.</p>
    <p>When an email message with password-protected attachments arrives, if <a href="trend-vision-one-password-guessing-attachment">Attachment Password Guessing</a> is enabled, Cloud Email and Collaboration Protection first attempts to find passwords in the message to decrypt the attachments for scanning. If no password is found or Attachment Password Guessing is not enabled, Cloud Email and Collaboration Protection treats the attachments as unscannable and perform the action for <strong>Password-protected compressed files</strong> or <strong>Other password-protected files</strong>, depending on whether the attachments are compressed.</p></td>
    </tr>
    </tbody>
    </table>
    :::

5.  Configure **Notification** settings.

    ::: {.simpletable-container}
    <table id="GUID-3E119A85-CEE9-4732-962D-DC621E3E3762__CHOICETABLE_GDD_W41_1Q" class="choicetable" data-border="1">
    <colgroup>
    <col style="width: 50%" />
    <col style="width: 50%" />
    </colgroup>
    <thead>
    <tr class="chhead table-header-style">
    <th class="choptionhd">Option</th>
    <th class="chdeschd">Description</th>
    </tr>
    </thead>
    <tbody>
    <tr class="chrow">
    <td class="choption"><p>Notify administrator</p></td>
    <td class="chdesc"><ol>
    <li><p>Specify the administrators to notify by selecting a recipient group or specifying individual recipients. You can click Manage recipient groups to edit the members in a group or add more groups.</p></li>
    <li><p>Specify message details to notify administrators that Cloud Email and Collaboration Protection detected a security risk and took action on an email message, attachment, or file.</p></li>
    <li><p>Set the notification threshold which limits the number of notification messages to send. Threshold settings include:</p>
    <ul>
    <li><p><strong>Send consolidated notifications periodically</strong>: Cloud Email and Collaboration Protection sends an email message that consolidates all the notifications for a period of time. Specify the period of time by typing a number in the box and selecting hour(s) or day(s).</p></li>
    <li><p><strong>Send consolidated notifications by occurrences</strong>: Cloud Email and Collaboration Protection sends an email message that consolidates notifications for a set number of filtering actions. Specify the number of virus/malware occurrences by typing a number in the box.</p></li>
    <li><p><strong>Send individual notifications</strong>: Cloud Email and Collaboration Protection sends an email message notification every time Cloud Email and Collaboration Protection performs a filtering action.</p></li>
    </ul></li>
    </ol></td>
    </tr>
    <tr class="chrow">
    <td class="choption"><p>Notify User</p></td>
    <td class="chdesc"><p><strong>Exchange Online and Gmail</strong>: Specify message details that notify recipients that Cloud Email and Collaboration Protection detected a security risk and took action on their email message or attachment.</p>
    <p><strong>SharePoint Online, OneDrive, Microsoft Teams (Teams), Box, Dropbox, and Google Drive</strong>: Specify message details that notify the user who updated a file that Cloud Email and Collaboration Protection detected a security risk and took action on their file.</p>
    <p><strong>Teams Chat</strong>: Cloud Email and Collaboration Protection does not provide this option. When a chat message was blocked, a notification "This message was blocked." provided by Microsoft appears in the sender's private chat window. Message senders can click <strong>What can I do?</strong> to view more information about the blocked messages.</p></td>
    </tr>
    </tbody>
    </table>
    :::

    :::note

    When specifying a notification message, include relevant tokens and edit the message content as desired. For details about tokens, see [Token list](token-list.mdx).
    :::

6.  Click **Save** or select another policy configuration on the left navigation to continue with additional rules.

**Related information**

- About predictive machine learning

## About predictive machine learning {#about-predictive-machine-learning}

Trend Micro Predictive Machine Learning uses advanced machine learning technology to correlate threat information and perform in-depth file analysis to detect emerging unknown security risks through digital DNA fingerprinting, API mapping, and other file features. Predictive Machine Learning is a powerful tool that helps protect your environment from unidentified threats and zero-day attacks.

After detecting an unknown or low-prevalence file, Cloud Email and Collaboration Protection scans the file using the Advanced Threat Scan Engine to extract file features and sends the report to the Predictive Machine Learning engine. Through use of malware modeling, Predictive Machine Learning compares the sample to the malware model, assigns a probability score, and determines the probable malware type that the file contains.
:::
