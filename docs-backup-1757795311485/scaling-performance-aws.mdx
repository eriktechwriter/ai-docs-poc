---
slug: trend-vision-one-scaling-performance-aws
title: Scaling and performance with AWS
---
# Scaling and performance with AWS

The below information details scaling and performance of File Security Storage for Amazon Web Service (AWS).

### Performance metrics {#performance-metrics}

Below are some estimates of how long a scan takes for various file types.

**File scan times for File Security Storage with AWS**

<table>
<thead style="text-align: left;">
<tr>
<th style="text-align: left;"><p>File type</p></th>
<th style="text-align: left;"><p>Size</p></th>
<th style="text-align: left;"><p>Time</p></th>
</tr>
</thead>
<tbody style="text-align: left;">
<tr>
<td style="text-align: left;"><p>BIN</p></td>
<td style="text-align: left;"><p>&lt; 100 MB</p></td>
<td style="text-align: left;"><p>4 seconds</p></td>
</tr>
<tr>
<td style="text-align: left;"><p>EXE</p></td>
<td style="text-align: left;"><p>&lt; 100 MB</p></td>
<td style="text-align: left;"><p>4 seconds</p></td>
</tr>
<tr>
<td style="text-align: left;"><p>JPG</p></td>
<td style="text-align: left;"><p>&lt; 10 MB</p></td>
<td style="text-align: left;"><p>3 seconds</p></td>
</tr>
<tr>
<td style="text-align: left;"><p>MP4</p></td>
<td style="text-align: left;"><p>&lt; 1600 MB</p></td>
<td style="text-align: left;"><p>22 seconds</p></td>
</tr>
<tr>
<td style="text-align: left;"><p>PDF</p></td>
<td style="text-align: left;"><p>&lt; 1500 MB</p></td>
<td style="text-align: left;"><p>22 seconds</p></td>
</tr>
<tr>
<td style="text-align: left;"><p>TXT</p></td>
<td style="text-align: left;"><p>&lt; 100 MB</p></td>
<td style="text-align: left;"><p>4 seconds</p></td>
</tr>
<tr>
<td style="text-align: left;"><p>ZIP</p></td>
<td style="text-align: left;"><p>&lt; 100 MB</p></td>
<td style="text-align: left;"><p>5 seconds</p></td>
</tr>
</tbody>
</table>

### How are bursts in load handled? How do I estimate the scan time and how much concurrency is used when a burst of scanning occurs? {#how-are-bursts-in-load-handled-how-do-i-estimate-the-scan-time-and-how-much-concurrency-is-used-when-a-burst-of-scanning-occurs}

If a large number of scanning requests hit File Storage Security all at once, multiple instances of the [ScannerLambda](https://docs.trendmicro.com/en-us/documentation/article/trend-micro-cloud-one-file-storage-security-arch-overview-aws) will be invoked to process the requests in parallel.

The exact scan time depends on the [AWS concurrency settings](https://docs.aws.amazon.com/lambda/latest/dg/configuration-concurrency.mdx) of the Lambda functions, and well as how many other Lambdas you have running at the same time in your AWS account.

The Lambda concurrency setting number includes not only the Lambdas that File Storage Security uses, but also all the other Lambdas used in the same AWS account. You can leave this setting at its default (set by AWS) and make sure the Lambda concurrency in this AWS account is sufficient for the File Storage Security scan.

Below are some estimates of how long a scan takes and how much concurrency was used for various numbers of zipped 10 MB files. The data in the table was collected in a deployment where there was one storage stack and one scanner in the same region.

**Concurrent file scan times for File Security Storage with AWS**

<table>
<thead>
<tr>
<th>Total number of files</th>
<th>Used concurrency of the Scanner Lambda</th>
<th>Total scan time (seconds)</th>
</tr>
</thead>
<tbody>
<tr>
<td>1000</td>
<td>53</td>
<td>40</td>
</tr>
<tr>
<td>700</td>
<td>44</td>
<td>35</td>
</tr>
<tr>
<td>300</td>
<td>26</td>
<td>23</td>
</tr>
<tr>
<td>100</td>
<td>19</td>
<td>17</td>
</tr>
<tr>
<td>10</td>
<td>5</td>
<td>6</td>
</tr>
</tbody>
</table>

When the shared or reserved concurrency is lower than the requirement for the used concurrency, delays can be expected due to throttles.

In addition, there are three Lambda concurrencies invoked in the scan process, namely, the BucketListener, Scanner, and PostScanActionTag Lambda concurrencies. When a burst of traffic occurs in an architecture with one S3 bucket and one scanner, the BucketListener Lambda needs more concurrency.

<table>
<thead>
<tr>
<th>Total number of files</th>
<th>BucketListener</th>
<th>Scanner</th>
<th>PostScanActionTag</th>
</tr>
</thead>
<tbody>
<tr>
<td>1000</td>
<td>137</td>
<td>53</td>
<td>11</td>
</tr>
<tr>
<td>700</td>
<td>128</td>
<td>44</td>
<td>10</td>
</tr>
<tr>
<td>300</td>
<td>193</td>
<td>26</td>
<td>8</td>
</tr>
<tr>
<td>100</td>
<td>96</td>
<td>19</td>
<td>4</td>
</tr>
<tr>
<td>10</td>
<td>10</td>
<td>5</td>
<td>5</td>
</tr>
</tbody>
</table>

### How many files can be scanned concurrently? {#how-many-files-can-be-scanned-concurrently}

The AWS Lambda service has a default setting of 1000 total allowable concurrent executions, and File Storage Security's ScannerLambda function follows this configuration. Thus, if two File Storage Security scanners are deployed under the same AWS account in the same region, the 1000 concurrent executions will be shared among the scanners (they won't each get 1000). Additionally, the concurrent executions will be further split with any other Lambdas deployed under the same AWS account in the same region.

The ScannerLambda receives scan messages by setting up an event source mapping to the SQS ScannerQueue. The maximum number of batches that an event source mapping can process simultaneously is 1000, and the batch size for the ScannerLambda is 1. In other words, ScannerLambda can poll at most 1000 scan messages from the SQS ScannerQueue simultaneously, even if there are still allowable concurrent executions. The polling latency determines the actual amount of scan messages that can be handled simultaneously. If the latency is 1 second, the maximum number of scan messages that can be handled in 1 second is bound to 1000. When the file uploading speed is higher than that amount, the scan messages are queued in the SQS ScannerQueue.

File identification information is also scanned by the Trend Micro Global Smart Protection Server in the cloud. (See [Architecture and flow](https://docs.trendmicro.com/en-us/documentation/article/trend-micro-cloud-one-file-storage-security-arch-overview-aws) for details.) This server is set up to handle very large loads from across the globe and will never cause a performance bottleneck.
:::
