"use strict";(self.webpackChunktrend_vision_one_docs=self.webpackChunktrend_vision_one_docs||[]).push([[3115],{28453:(e,n,s)=>{s.d(n,{R:()=>d,x:()=>l});var i=s(96540);const r={},c=i.createContext(r);function d(e){const n=i.useContext(c);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:d(e.components),i.createElement(c.Provider,{value:n},e.children)}},50277:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>t,contentTitle:()=>l,default:()=>a,frontMatter:()=>d,metadata:()=>i,toc:()=>h});const i=JSON.parse('{"id":"search-identifier-element","title":"The search-identifier element","description":"search-identifier elements define the specific patterns Trend Vision One uses to detect events. A filter can contain up to 19 search-identifier elements.","source":"@site/docs/search-identifier-element.md","sourceDirName":".","slug":"/trend-vision-one-search-identifier-element","permalink":"/ai-docs-poc/trend-vision-one-search-identifier-element","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"slug":"trend-vision-one-search-identifier-element","title":"The search-identifier element"}}');var r=s(74848),c=s(28453);const d={slug:"trend-vision-one-search-identifier-element",title:"The search-identifier element"},l=void 0,t={},h=[{value:"Components",id:"components",level:3},{value:"Guidelines",id:"guidelines",level:3},{value:"Special Field Values",id:"special-field-values",level:3}];function o(e){const n={a:"a",code:"code",col:"col",colgroup:"colgroup",h3:"h3",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,c.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"search-identifier"})," elements define the specific patterns Trend Vision One uses to detect events. A filter can contain up to 19 ",(0,r.jsx)(n.code,{children:"search-identifier"})," elements."]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Components"}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Guidelines"}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Special field values"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"components",children:"Components"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-codeblock",children:"{search-identifier key}:\n    {List or object}\n    {List or object}\n    ....\n    {List or object}\n"})}),"\n",(0,r.jsx)(n.p,{children:"The following table outlines the components of search-identifier elements:"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsxs)(n.colgroup,{children:["\n",(0,r.jsx)(n.col,{style:{width:"25%"}}),"\n",(0,r.jsx)(n.col,{style:{width:"75%"}}),"\n"]}),(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:(0,r.jsx)(n.p,{children:"Component"})}),(0,r.jsx)(n.th,{children:(0,r.jsx)(n.p,{children:"Description"})})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.p,{children:"Search-identifier key"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.p,{children:"Key of the search-identifier."})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.p,{children:"List"})}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.p,{children:"List of strings that the filter attempts to localize in the detection logs"}),"\n",(0,r.jsxs)(n.p,{children:["All elements in a list are matched using the ",(0,r.jsx)(n.code,{children:"OR"})," operator. Use the field names defined in the ",(0,r.jsx)(n.a,{href:"trend-vision-one-search-method-data-sources",children:"search method data sources"})," to create lists."]}),"\n",(0,r.jsx)(n.pre,{className:"codeblock",children:(0,r.jsx)(n.code,{children:"eventSub:\n    eventSubId:\n        - TELEMETRY_CONNECTION_CONNECT_OUTBOUND\n        - TELEMETRY_CONNECTION_CONNECT_INBOUND\n       "})})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Object"}),(0,r.jsxs)(n.td,{children:[(0,r.jsxs)(n.p,{children:["Objects consist of key-value pairs. All elements in an object are matched using the ",(0,r.jsx)(n.code,{children:"AND"})," operator."]}),"\n",(0,r.jsxs)(n.p,{children:["Use the field names defined in the ",(0,r.jsx)(n.a,{href:"trend-vision-one-search-method-data-sources",children:"search method data sources"})," to create objects."]}),"\n",(0,r.jsx)(n.pre,{className:"codeblock",children:(0,r.jsx)(n.code,{children:"detection:\n    selection:\n        dpt:\n            - 5650\n            - 5655\n        processCmd: '*-run_agent*'\n    condition: selection\n       "})})]})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"guidelines",children:"Guidelines"}),"\n",(0,r.jsx)(n.p,{children:"The following table outlines the guidelines to create search-identifier elements."}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsxs)(n.colgroup,{children:["\n",(0,r.jsx)(n.col,{style:{width:"20%"}}),"\n",(0,r.jsx)(n.col,{style:{width:"80%"}}),"\n"]}),(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:(0,r.jsx)(n.p,{children:"Section"})}),(0,r.jsx)(n.th,{children:(0,r.jsx)(n.p,{children:"Description"})})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.p,{children:"Strings"})}),(0,r.jsx)(n.td,{children:(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.p,{children:"Strings are case-insensitive."})}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsxs)(n.p,{children:["Enclose strings with apostrophes (",(0,r.jsx)(n.code,{children:"'"}),")."]}),"\n",(0,r.jsxs)(n.p,{children:["Example: ",(0,r.jsx)(n.code,{children:"eventName: 'GetParameter'"})]})]}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsxs)(n.p,{children:["Use backslashes (",(0,r.jsx)(n.code,{children:"\\"}),") to escape strings."]})}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.p,{children:"Escaping strings is only needed for the following characters:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsxs)(n.p,{children:["Apostrophes (",(0,r.jsx)(n.code,{children:"'"}),")"]}),"\n",(0,r.jsxs)(n.p,{children:["Example: ",(0,r.jsx)(n.code,{children:"message: 'I don\\'t know.'"})]})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsxs)(n.p,{children:["Asterisks (",(0,r.jsx)(n.code,{children:"*"}),") when used as regular characters"]}),"\n",(0,r.jsxs)(n.p,{children:["Example: ",(0,r.jsx)(n.code,{children:"string: '5 \\* 2 = 10'"})]})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsxs)(n.p,{children:["Backslashes (",(0,r.jsx)(n.code,{children:"\\"}),") when used as regular characters"]}),"\n",(0,r.jsxs)(n.p,{children:["Example: ",(0,r.jsx)(n.code,{children:"path: 'C:\\\\Windows\\\\notepad.exe'"})]})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsxs)(n.p,{children:["Question marks (",(0,r.jsx)(n.code,{children:"?"}),")"]}),"\n",(0,r.jsxs)(n.p,{children:["Example: ",(0,r.jsx)(n.code,{children:"url: 'https://www.google.com/search\\?q=weather'"})]})]}),"\n"]})]}),"\n"]})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.p,{children:"Wildcards"})}),(0,r.jsxs)(n.td,{children:[(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsxs)(n.p,{children:["Use an asterisk (",(0,r.jsx)(n.code,{children:"*"}),") as a wildcard for unknown parts of the string. Do not use multiple asterisks (",(0,r.jsx)(n.code,{children:"**"}),") as wildcards."]})}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.a,{href:"trend-vision-one-trend-micro-sigma-specification",children:"Trend Micro Sigma specification"})," allows the following special modifiers for searching strings:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsxs)(n.p,{children:["Check if a string ends with the specified characters: ",(0,r.jsx)(n.code,{children:"*string"})]})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsxs)(n.p,{children:["Check if a string starts with the specified characters: ",(0,r.jsx)(n.code,{children:"string*"})]})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsxs)(n.p,{children:["Check if a string contains the specified characters: ",(0,r.jsx)(n.code,{children:"*string*"})]})}),"\n"]})]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.a,{href:"trend-vision-one-search-method-data-sources",children:"Fields"})," marked as ",(0,r.jsx)(n.code,{children:"dynamic"})," only support the special modifier ",(0,r.jsx)(n.code,{children:"*string*"}),". Dynamic fields do not support exact match strings."]})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.p,{children:"Numeric values"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.p,{children:"Numeric values do not require apostrophes."})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.p,{children:"Value modifiers"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.p,{children:"Value modifiers are not allowed in custom filters."})})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"special-field-values",children:"Special Field Values"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Avoid using the following special field values:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Empty values (",(0,r.jsx)(n.code,{children:"''"}),", ",(0,r.jsx)(n.code,{children:"null"}),")"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Single character wildcards (",(0,r.jsx)(n.code,{children:"?"}),")"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["For the ",(0,r.jsx)(n.code,{children:"eventId"})," and ",(0,r.jsx)(n.code,{children:"eventSubId"})," fields, use the data field mapping value instead of the numeric value."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-codeblock",children:"eventSubId: TELEMETRY_PROCESS_OPEN # Instead of eventSubId: 1\n"})}),"\n"]}),"\n"]})]})}function a(e={}){const{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}}}]);