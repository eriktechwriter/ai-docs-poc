"use strict";(self.webpackChunktrend_vision_one_docs=self.webpackChunktrend_vision_one_docs||[]).push([[1823],{28453:(n,e,s)=>{s.d(e,{R:()=>l,x:()=>o});var t=s(96540);const i={},r=t.createContext(i);function l(n){const e=t.useContext(r);return t.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function o(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:l(n.components),t.createElement(r.Provider,{value:e},n.children)}},42610:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>d,contentTitle:()=>o,default:()=>x,frontMatter:()=>l,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"uninstall-agents-intune","title":"Uninstall Windows Agents with Microsoft Intune","description":"Create a Microsoft Intune app to deploy the uninstall tool and remove the agent program for your endpoints.","source":"@site/docs/uninstall-agents-intune.md","sourceDirName":".","slug":"/trend-vision-one-uninstall-agents-intune","permalink":"/ai-docs-poc/trend-vision-one-uninstall-agents-intune","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"slug":"trend-vision-one-uninstall-agents-intune","title":"Uninstall Windows Agents with Microsoft Intune"}}');var i=s(74848),r=s(28453);const l={slug:"trend-vision-one-uninstall-agents-intune",title:"Uninstall Windows Agents with Microsoft Intune"},o=void 0,d={},c=[{value:"Procedure",id:"procedure",level:3}];function h(n){const e={a:"a",admonition:"admonition",code:"code",col:"col",colgroup:"colgroup",h3:"h3",li:"li",ol:"ol",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.p,{children:"Create a Microsoft Intune app to deploy the uninstall tool and remove the agent program for your endpoints."}),"\n",(0,i.jsx)(e.admonition,{title:"Important",type:"warning",children:(0,i.jsx)(e.p,{children:"The steps are valid for Microsoft Intune as of December, 2023."})}),"\n",(0,i.jsxs)(e.p,{children:["Before you get started, make sure to download and unzip the ",(0,i.jsx)(e.a,{href:"https://github.com/Microsoft/Microsoft-Win32-Content-Prep-Tool",children:"Microsoft Win32 Content Prep Tool"}),"."]}),"\n",(0,i.jsx)(e.h3,{id:"procedure",children:"Procedure"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["On the Trend Vision One console, go to ",(0,i.jsx)(e.strong,{children:"Endpoint Security \u2192 Endpoint Inventory"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["Click ",(0,i.jsx)(e.strong,{children:"Agent Installer"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["Click the ",(0,i.jsx)(e.strong,{children:"download the uninstall tool"})," link at the bottom of the ",(0,i.jsx)(e.strong,{children:"Agent Installer"})," screen."]}),"\n",(0,i.jsx)(e.admonition,{type:"note",children:(0,i.jsx)(e.p,{children:"If you do not see the link, you might not have permission to perform this action. Contact your system administrator."})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["In the ",(0,i.jsx)(e.strong,{children:"Download Uninstall Tool"})," screen, locate ",(0,i.jsx)(e.strong,{children:"Windows (32-bit, 64-bit)"})," and click the ",(0,i.jsx)(e.strong,{children:"Download tool"})," button."]}),"\n",(0,i.jsx)(e.admonition,{type:"note",children:(0,i.jsx)(e.p,{children:"The downloaded uninstall tool expires after seven days."})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Unzip the uninstall tool package."}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["Locate where you have downloaded and unzipped the ",(0,i.jsx)(e.a,{href:"https://github.com/Microsoft/Microsoft-Win32-Content-Prep-Tool",children:"Microsoft Win32 Content Prep Tool"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["Run ",(0,i.jsx)(e.code,{children:"IntuneWinAppUtil.exe"})," and specify the information when prompted."]}),"\n",(0,i.jsxs)(e.table,{children:[(0,i.jsxs)(e.colgroup,{children:["\n",(0,i.jsx)(e.col,{style:{width:"50%"}}),"\n",(0,i.jsx)(e.col,{style:{width:"50%"}}),"\n"]}),(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:(0,i.jsx)(e.p,{children:"Prompt"})}),(0,i.jsx)(e.th,{children:(0,i.jsx)(e.p,{children:"Setting"})})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.p,{children:"Source folder"})}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.p,{children:"Specify the directory where the uninstall tool is located"})})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.p,{children:"Setup file"})}),(0,i.jsx)(e.td,{children:(0,i.jsxs)(e.p,{children:["Type the full file path with ",(0,i.jsx)(e.code,{children:"V1ESUninstallTool.exe"})]})})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.p,{children:"Output folder"})}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.p,{children:"Specify the destination for the created package"})})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.p,{children:"Specify catalog folder"})}),(0,i.jsx)(e.td,{children:(0,i.jsxs)(e.p,{children:["Type ",(0,i.jsx)(e.code,{children:"N"})]})})]})]})]}),"\n",(0,i.jsxs)(e.p,{children:["The tool creates a deployment package named ",(0,i.jsx)(e.code,{children:"V1ESUninstallTool.intunewin"})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["In Microsoft Intune, go to ",(0,i.jsx)(e.strong,{children:"Apps \u2192 All apps"})," and click ",(0,i.jsx)(e.strong,{children:"Add"}),"."]}),"\n",(0,i.jsxs)(e.p,{children:["The ",(0,i.jsx)(e.strong,{children:"Select app type"})," window appears."]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["Select ",(0,i.jsx)(e.strong,{children:"Windows app (Win32)"}),"."]}),"\n",(0,i.jsxs)(e.p,{children:["The ",(0,i.jsx)(e.strong,{children:"Add App"})," window appears."]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["On the ",(0,i.jsx)(e.strong,{children:"App information"})," tab, click ",(0,i.jsx)(e.strong,{children:"Select app package file"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["In the ",(0,i.jsx)(e.strong,{children:"App package file"})," screen, click the folder icon to locate the ",(0,i.jsx)(e.code,{children:"V1ESUninstallTool.intunewin"})," package."]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["Click ",(0,i.jsx)(e.strong,{children:"OK"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["Specify a unique ",(0,i.jsx)(e.strong,{children:"Name"})," for the app."]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["Specify a ",(0,i.jsx)(e.strong,{children:"Description"})," to easily identify the purpose of the app."]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["For ",(0,i.jsx)(e.strong,{children:"Publisher"}),", type ",(0,i.jsx)(e.code,{children:"Trend Micro"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["Click ",(0,i.jsx)(e.strong,{children:"Next"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["Configure the ",(0,i.jsx)(e.strong,{children:"Program"})," tab and click ",(0,i.jsx)(e.strong,{children:"Next"}),"."]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Install command"}),": Type ",(0,i.jsx)(e.code,{children:"V1ESUninstallTool.exe"})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Uninstall command"}),": Type ",(0,i.jsx)(e.code,{children:"V1ESUninstallTool.exe /qn"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["Configure the ",(0,i.jsx)(e.strong,{children:"Requirements"})," tab and click ",(0,i.jsx)(e.strong,{children:"Next"}),"."]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Operating system architecture"}),": Select ",(0,i.jsx)(e.strong,{children:"64-bit"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Minimum operating system"}),": Refer to the ",(0,i.jsx)(e.a,{href:"/ai-docs-poc/trend-vision-one-endpoint-agent-system-requirements",children:"Endpoint Agent System Requirements"})," for your agent and security environment needs."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["Configure the ",(0,i.jsx)(e.strong,{children:"Detection rules"})," tab."]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["For ",(0,i.jsx)(e.strong,{children:"Rules format"}),", select ",(0,i.jsx)(e.strong,{children:"Manually configure detection rules"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["Click ",(0,i.jsx)(e.strong,{children:"Add"})," to add new detection rules."]}),"\n",(0,i.jsx)(e.admonition,{title:"Important",type:"warning",children:(0,i.jsx)(e.p,{children:"Only use the rules for the type of agent you want to uninstall. Adding rules for more than one agent type may cause the uninstall process to fail."})}),"\n",(0,i.jsxs)(e.table,{children:[(0,i.jsxs)(e.colgroup,{children:["\n",(0,i.jsx)(e.col,{style:{width:"25%"}}),"\n",(0,i.jsx)(e.col,{style:{width:"25%"}}),"\n",(0,i.jsx)(e.col,{style:{width:"50%"}}),"\n"]}),(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:(0,i.jsx)(e.p,{children:"Agent Type"})}),(0,i.jsx)(e.th,{children:(0,i.jsx)(e.p,{children:"Rule Type"})}),(0,i.jsx)(e.th,{children:(0,i.jsx)(e.p,{children:"Settings"})})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{rowSpan:"2",children:(0,i.jsx)(e.p,{children:"Endpoint Sensor"})}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.p,{children:"File"})}),(0,i.jsx)(e.td,{children:(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Path"}),": Type ",(0,i.jsx)(e.code,{children:"%ProgramFiles (x86)%\\Trend Micro\\Endpoint Basecamp"})]})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"File or folder"}),": Type ",(0,i.jsx)(e.code,{children:"EndpointBasecamp.exe"})]})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Detection method"}),": Select ",(0,i.jsx)(e.strong,{children:"File or folder does not exist"}),"."]})}),"\n"]})})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.p,{children:"File"})}),(0,i.jsx)(e.td,{children:(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Path"}),": Type ",(0,i.jsx)(e.code,{children:"%ProgramFiles%\\Trend Micro\\"})]})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"File or folder"}),": Type ",(0,i.jsx)(e.code,{children:"Cloud Endpoint"})]})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Detection method"}),": Select ",(0,i.jsx)(e.strong,{children:"File or folder does not exist"}),"."]})}),"\n"]})})]})]})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["Click ",(0,i.jsx)(e.strong,{children:"Next"}),", then click ",(0,i.jsx)(e.strong,{children:"Next"})," again to go to the ",(0,i.jsx)(e.strong,{children:"Scope tags"})," tab."]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["Click ",(0,i.jsx)(e.strong,{children:"Select scope tags"})," to assign a scope tag for the agent installer."]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["Click ",(0,i.jsx)(e.strong,{children:"Next"})," to go to the ",(0,i.jsx)(e.strong,{children:"Assignments"})," tab."]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["Add the groups or users you wish to deploy the agent installer to, then click ",(0,i.jsx)(e.strong,{children:"Next"}),"."]}),"\n",(0,i.jsx)(e.p,{children:"Trend Micro recommends leveraging filters to select by specific user or machine to avoid any errors during the uninstalling process."}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["Review the settings and then click ",(0,i.jsx)(e.strong,{children:"Create"}),"."]}),"\n",(0,i.jsxs)(e.p,{children:["Once the app runs, the agent is uninstalled from the target endpoints. Endpoint Inventory might take some time to update the information. Some endpoints might require you to manually update the endpoint lists. For more information, see ",(0,i.jsx)(e.a,{href:"/ai-docs-poc/trend-vision-one-cleaning-up-uninstalled-agents",children:"Cleaning Up Uninstalled Agents"}),"."]}),"\n"]}),"\n"]})]})}function x(n={}){const{wrapper:e}={...(0,r.R)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(h,{...n})}):h(n)}}}]);