"use strict";(self.webpackChunktrend_vision_one_docs=self.webpackChunktrend_vision_one_docs||[]).push([[8975],{4540:(e,n,s)=>{s.d(n,{A:()=>t});const t="data:image/webp;base64,UklGRlIBAABXRUJQVlA4IEYBAACwBgCdASoSABEAPh0MhEGhBQGqBABxLUAWI3hCpO0l4ADpKP21Jot43Rymz8h0w9dab8Mzn7KYEgfIPZ7wAAD+/7y04zaVRfrT/xTyeGV1/xMQcvj0JC9v/HfZ+2er6kIgPfXoH1vp2tMr1YwOsl3395PkL4o/l4nzM5UWnuDIDH26MT4jY3TMJT6A/x6pc0XMxKpSHCL8PqPqP/NsmzqG3s9+//4fpuzjtp2foQjiW/btrzN8Hy4GANbGnfr8pEg/+NYx3Ip7O/vXsb5U+n/+x98bJCNib/9aKfq5/dNFTe6HusT+Lo3G/ZfQ/38CFWu3xM/jRPSPkV6lOYG9/QdtiJSbd2kWZptk/YxkjFQpW8vA1jEGcsQVvOzC6AT2VjFC55yHE1j1u/Nmk//DI+UkGAnaiyQhrUWSESkJX2AMPqXEAAAAAA=="},28453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>c});var t=s(96540);const i={},r=t.createContext(i);function o(e){const n=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),t.createElement(r.Provider,{value:n},e.children)}},57111:(e,n,s)=>{s.d(n,{A:()=>t});const t="data:image/webp;base64,UklGRo4BAABXRUJQVlA4WAoAAAAIAAAAEQAAEAAAVlA4IE4BAABQBwCdASoSABEAPh0MhEGhBQGqBABxLYATplCPMxVthIAMoA3wDKYP2V9FUpk3jUHkEpril2trWab3eAJ1JnbD01nQAP7/vLThVN1IFR/4xAw+shxD3uEbCazD3U8j4njZGDkGa6X2722G8B/ZjIDAwkXn6j8ZKkER9/wvD+nTJF56mgVXkBPuGmVhlYU/81tLn03f8eoQn2i31ADHYZUKHhGt3I3/1zreblv8AIRcSkXGkSYXrEqzacvkXEjOB9Ricy9cTbS/8f/wDXS1C43ee/E5SeOOl07zX8Z8SRf/3pn/uv+Jvwez5yIlfP/zEv+/Kf+HPjgwbP5ihB/35P/sAP7Msafw6L0faR/1J13/Ud1hVHJliicwvOZlyiov+szlCwuUILVlzX9iQaq0rlwFhustGZ0rwjiDukrCz5AouPq8+PgisgzWBqMkwAAARVhJRhoAAABNTQAqAAAACAABARIAAwAAAAEAAQAAAAAAAA=="},74028:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>h,frontMatter:()=>o,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"run-remote-custom-script-task","title":"Run Remote Custom Script task","description":"Execute a PowerShell or Bash script on a target endpoint during an investigation.","source":"@site/docs/run-remote-custom-script-task.md","sourceDirName":".","slug":"/trend-vision-one-run-remote-custom-script-task","permalink":"/ai-docs-poc/trend-vision-one-run-remote-custom-script-task","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"slug":"trend-vision-one-run-remote-custom-script-task","title":"Run Remote Custom Script task"}}');var i=s(74848),r=s(28453);const o={slug:"trend-vision-one-run-remote-custom-script-task",title:"Run Remote Custom Script task"},c=void 0,l={},d=[{value:"Procedure",id:"procedure",level:3}];function a(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.p,{children:"Execute a PowerShell or Bash script on a target endpoint during an investigation."}),"\n",(0,i.jsx)(n.p,{children:"Remote custom scripts allows Master Administrator and Security Analyst roles to directly access target endpoints to run a previously uploaded PowerShell and Bash script files."}),"\n",(0,i.jsx)(n.p,{children:"This task is supported by the following services:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Trend Vision One"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Windows agent"}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Mac agent"}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Linux agent"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Trend Cloud One - Endpoint & Workload Security"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Windows agent"}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Mac agent"}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Linux agent"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.admonition,{title:"Important",type:"warning",children:[(0,i.jsx)(n.p,{children:"The following recommendations apply only to PowerShell scripts executed on Windows endpoints:"}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["The target endpoint's PowerShell execution policy must be set to ",(0,i.jsx)(n.code,{children:"RemoteSigned"}),", otherwise the script may be blocked. RemoteSigned is the default execution policy."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Trend Micro recommends you configure the PowerShell session language mode to ",(0,i.jsx)(n.code,{children:"FullLanguage"}),", otherwise the script may be blocked. ",(0,i.jsx)(n.code,{children:"FullLanguage"})," is the default language mode for default sessions on all versions of Windows except for Windows RT."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"The script file must not include interactive functions. Because scripts run in silent mode, interactive functions will cause scripts to time out."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["For an example of a signed script, see ",(0,i.jsx)(n.a,{href:"/ai-docs-poc/trend-vision-one-sample-signed-powershell-script",children:"Sample signed PowerShell script"}),"."]}),"\n"]}),"\n"]}),(0,i.jsx)(n.p,{children:"To learn more about the above settings, please consult the Microsoft PowerShell official documentation site."})]}),"\n",(0,i.jsx)(n.h3,{id:"procedure",children:"Procedure"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["After identifying the endpoint to investigate, access the context or response menu and click ",(0,i.jsx)(n.strong,{children:"Run Remote Custom Script"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.strong,{children:"Run Remote Custom Script Task"})," screen appears and Trend Vision One attempts to connect to the endpoint."]}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsx)(n.p,{children:"Trend Vision One only permits you to execute one custom script file per session. The target endpoint must be online in order to connect successfully."})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Select the previously uploaded custom script file from the drop-down list."}),"\n",(0,i.jsxs)(n.p,{children:["To add a new custom script, go to ",(0,i.jsx)(n.strong,{children:"Custom Scripts"})," on the ",(0,i.jsx)(n.strong,{children:"Response Scripts"})," tab of Response Management. Click ",(0,i.jsx)(n.strong,{children:"Add script"})," to upload a new script file."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"(Optional) Specify the arguments that are added onto the script during script execution."}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsx)(n.p,{children:"You can specify a maximum of 8,000 characters."})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Specify a ",(0,i.jsx)(n.strong,{children:"Description"})," for the response or event."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Click ",(0,i.jsx)(n.strong,{children:"Create"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["Trend Vision One creates the task and displays the current task status in ",(0,i.jsx)(n.strong,{children:"Response Management"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Monitor the task status."}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Open ",(0,i.jsx)(n.strong,{children:"Response Management"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["(Optional) Locate the task using the ",(0,i.jsx)(n.strong,{children:"Search"})," field or by selecting ",(0,i.jsx)(n.strong,{children:"Run Remote Custom Script"})," from the ",(0,i.jsx)(n.strong,{children:"Action"})," drop-down list."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"View the task status."}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.em,{children:"In progress"})," (",(0,i.jsx)(n.img,{src:s(4540).A+"",width:"18",height:"17"}),"): Trend Vision One sent the command and is waiting for a response."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.em,{children:"Successful"})," (",(0,i.jsx)(n.img,{src:s(57111).A+"",width:"18",height:"17"}),"): The command was successfully executed."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.em,{children:"Unsuccessful"})," (",(0,i.jsx)(n.img,{src:s(79870).A+"",width:"18",height:"18"}),"): An error or time-out occurred when attempting to send the command to the managing server, the Security Agent is offline for more than 12 hours, or the command execution timed out."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Click the ",(0,i.jsx)(n.em,{children:"Task ID"})," to open the Details panel and ",(0,i.jsx)(n.strong,{children:"Download"})," the session history."]}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsx)(n.p,{children:"Use an external decompression program (such as 7-zip) to extract the file contents."})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Related information"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"/ai-docs-poc/trend-vision-one-sample-signed-powershell-script",title:"Refer to the following sample signed PowerShell script for the Run Remote Custom Script response action.",children:"Sample signed PowerShell script"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},79870:(e,n,s)=>{s.d(n,{A:()=>t});const t="data:image/webp;base64,UklGRsQBAABXRUJQVlA4ILgBAACwCgCdASoSABIAPikQhkIhoQoDVAwBQlsALEfNDA3lf4Z8gZu6Y49TfIB7nf8BgAHBAaVv7IX7AekA75qrzPRPsAfqj1Kw735+3iqHIVFXn5h2vf6o2++Jpviy7uYAAP7/gd3u9TBKpjtatz95hts2kHILiNC3o/+bb+PifQtXJCsUpm/b+XCzsuL93XQy8J/fu39k1jrTxXVsP3+U3sEuE7dTknJ+hH2Tg0tEIcm3fFeqhsf440p9O9mnQxv5/H814p+jr/JPI9Cqz31QkWon9J0HcAARX/OU7Kj3TQ3QNcmK1qOHcZIpeR/gBm5ZPSJ/+MWupGwj/7RgfUMs5VbVGaNYZzmM45IobzxTA91R/+4hPf+KI+//2NMcMGp8SYT/ksDfjOBxdGOJrLZxO8nUrzja06W38nmi/PS20vHJPD/802DeJnymnrgB693iYLPySi6ypBYjpIENKz+FbQVGGfsrhmmpWNdxtmNSPcUPOfgzzjeli6TOf/mxBdvSc7l6I8v8PtmNhYIpfkObRWlO4jslLh4+6Z4nR3A7K0vt3vx3E88AHA+u9+O4nj7PL2wAAXzWTDMAAA=="}}]);