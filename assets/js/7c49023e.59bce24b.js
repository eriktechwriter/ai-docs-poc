"use strict";(self.webpackChunktrend_vision_one_docs=self.webpackChunktrend_vision_one_docs||[]).push([[1954],{22907:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>t,contentTitle:()=>l,default:()=>x,frontMatter:()=>d,metadata:()=>s,toc:()=>o});const s=JSON.parse('{"id":"structure","title":"Structure","description":"The structure of filters is as follows:","source":"@site/docs/structure.md","sourceDirName":".","slug":"/trend-vision-one-structure","permalink":"/ai-docs-poc/trend-vision-one-structure","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"slug":"trend-vision-one-structure","title":"Structure"}}');var r=i(74848),c=i(28453);const d={slug:"trend-vision-one-structure",title:"Structure"},l=void 0,t={},o=[];function h(e){const n={a:"a",admonition:"admonition",code:"code",col:"col",colgroup:"colgroup",em:"em",figure:"figure",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,c.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.p,{children:"The structure of filters is as follows:"}),"\n",(0,r.jsxs)(n.figure,{children:["\n",(0,r.jsx)(n.pre,{className:"codeblock",children:(0,r.jsx)(n.code,{children:"title\ndescription [optional]\ntags [optional]\nlogsource\n   category\n   product [optional]\n   definition [optional]\ndetection\n   {search-identifier}\n      {List or object}\n   ...\n   condition\nlevel\ntaxonomy"})}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"The following table outlines the components supported in the Trend Micro Sigma specification."}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsxs)(n.colgroup,{children:["\n",(0,r.jsx)(n.col,{style:{width:"20%"}}),"\n",(0,r.jsx)(n.col,{style:{width:"80%"}}),"\n"]}),(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:(0,r.jsx)(n.p,{children:"Component"})}),(0,r.jsx)(n.th,{children:(0,r.jsx)(n.p,{children:"Description"})})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"title"})})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.p,{children:"The brief description of the filter (max. 256 characters)"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"description"})})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.p,{children:"The detailed description of the filter (max. 1024 characters)"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"tags"})})}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.p,{children:"The tags to categorize a filter"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.p,{children:"A filter can have up to 10 tags."})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.p,{children:"A tag can be up to 64 characters long."})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.p,{children:"Tags cannot have spaces."})}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsxs)(n.p,{children:["Tags can have namespaces. Use dots (",(0,r.jsx)(n.code,{children:"."}),") to separate the namespaces."]}),"\n",(0,r.jsx)(n.p,{children:"Example:"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"network.attack.123"}),"."]})]}),"\n"]})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"logsource"})})}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.p,{children:"The origin or type of data which the filter applies to"}),"\n",(0,r.jsx)(n.p,{children:"This section consists of three attributes:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.em,{children:"Category"}),": The data source"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.em,{children:"Product"}),": The platform that collects the information"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.em,{children:"Definition"}),": The event type"]}),"\n"]})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"category"})})}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.p,{children:"The type of data the filter queries"}),"\n",(0,r.jsx)(n.p,{children:"Supported values:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"CLOUD_ACTIVITY"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"CONTAINER_ACTIVITY"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"DETECTION"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"ENDPOINT_ACTIVITY"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"MESSAGE_ACTIVITY"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"MOBILE_ACTIVITY"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"NETWORK_ACTIVITY"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"IDENTITY_ACTIVITY"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"THIRD_PARTY_LOG"})}),"\n"]})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"product"})})}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.p,{children:"The platforms from which the data originates"}),"\n",(0,r.jsx)(n.p,{children:"Supported values:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"ENDPOINT_ACTIVITY"}),": ",(0,r.jsx)(n.code,{children:"windows"}),", ",(0,r.jsx)(n.code,{children:"linux"}),", ",(0,r.jsx)(n.code,{children:"mac"}),", ",(0,r.jsx)(n.code,{children:"unix"})]})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"MOBILE_ACTIVITY"}),": ",(0,r.jsx)(n.code,{children:"android"}),", ",(0,r.jsx)(n.code,{children:"ios"}),", ",(0,r.jsx)(n.code,{children:"chromeos"})]})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"CLOUD_ACTIVITY"}),": ",(0,r.jsx)(n.code,{children:"aws"})]})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"CONTAINER_ACTIVITY"}),": ",(0,r.jsx)(n.code,{children:"linux"})]})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"THIRD_PARTY_LOG"}),": Specify the third-party log vendors to detect corresponding third-party log events."]})}),"\n"]})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"definition"})})}),(0,r.jsxs)(n.td,{children:[(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.a,{href:"trend-vision-one-available-data-subtypes",children:"The specific subtype of data"})," the filter queries"]}),"\n",(0,r.jsx)(n.admonition,{title:"Warning",type:"danger",children:(0,r.jsxs)(n.p,{children:["To match ",(0,r.jsx)(n.code,{children:"AMAZON_SECURITY_LAKE"})," events, you must specify the definition as ",(0,r.jsx)(n.code,{children:"AMAZON_SECURITY_LAKE"}),"."]})}),"\n"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"detection"})})}),(0,r.jsxs)(n.td,{children:[(0,r.jsxs)(n.p,{children:["Consists of multiple ",(0,r.jsx)(n.code,{children:"search-identifier"})," elements and a ",(0,r.jsx)(n.code,{children:"condition"})," element"]}),"\n",(0,r.jsxs)(n.p,{children:["A filter can have up to 19 ",(0,r.jsx)(n.code,{children:"search-identifier"})," elements."]})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"trend-vision-one-search-identifier-element",children:"search-identifier"})})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.p,{children:"The specific patterns to detect events"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"condition"})})}),(0,r.jsxs)(n.td,{children:[(0,r.jsxs)(n.p,{children:["The logical operators and symbols that define how Trend Vision One processes the ",(0,r.jsx)(n.code,{children:"search-identifier"})," elements"]}),"\n",(0,r.jsx)(n.p,{children:"Supported operators:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.p,{children:"Logical operators AND/OR"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"keyword1 or keyword2"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"keyword1 and keyword2"})})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.p,{children:"Negation with NOT"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"keyword and not keyword 2"})})]}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsxs)(n.p,{children:["Select a single (",(0,r.jsx)(n.code,{children:"1 of them"}),") or all (",(0,r.jsx)(n.code,{children:"all of them"}),") of the defined search-identifier elements."]})}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.p,{children:"Select 1 or all of the specified elements."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"all of selection*"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"1 of selection* and keywords"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"1 of selection* and not 1 of filter*"})})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsxs)(n.p,{children:["Brackets ",(0,r.jsx)(n.code,{children:"()"})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"selection1 and (keywords1 or keywords2)"})})]}),"\n"]})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"level"})})}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.p,{children:"The severity associated with the event that this filter detects"}),"\n",(0,r.jsx)(n.p,{children:"Supported values:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"info"})})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"low"})})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"medium"})})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"high"})})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"critical"})})}),"\n"]})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"taxonomy"})}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.p,{children:"The taxonomy of the Sigma rule"}),"\n",(0,r.jsx)(n.admonition,{title:"Important",type:"warning",children:(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"tm-v1"})," is the only supported value for taxonomy."]})}),"\n"]})]})]})]})]})}function x(e={}){const{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},28453:(e,n,i)=>{i.d(n,{R:()=>d,x:()=>l});var s=i(96540);const r={},c=s.createContext(r);function d(e){const n=s.useContext(c);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:d(e.components),s.createElement(c.Provider,{value:n},e.children)}}}]);