---
id: run-osquery-task
title: Run osquery task
sidebar_label: Run osquery task
description: Run osquery task
tags:
  - endpoint-security
  - trend-vision-one
---

/*<![CDATA[*/ $('#title').html($('meta[name=map-description]').attr('content')); /*]]>*/ Run osquery task Run SQL-based queries on the specified endpoints to support threat investigation and incident response. Important This task is supported by the following services: Trend Vision One Linux agent macOS agent Windows agent This task uses osquery 5.7.0. For more information about the SQL syntax used in osquery 5.7.0, see osquery documentation. After creating a workspace and adding endpoints to the workspace in the Forensics app, you can collect detailed evidence from potentially compromised endpoints for internal investigations into critical incidents that occurred on your network and may require further attention. Procedure In the Trend Vision One console, go to Agentic SIEM & XDR → Forensics. Click the name of the workspace that has the endpoints you want to triage. Select one or more endpoints from the list. Selected endpoints must all use the same operating system. Click Run osquery. Note You can also perform this response from the context menu in XDR Data Explorer, Workbench, and Observed Attack Techniques. The Run osquery Task window appears. Configure the task. Use the radio buttons either to select an existing SQL query or to input a new query. Choose Select a query: Click Select a query, pause on a query to view its details, select a query, and click Continue. To add a new query to the selection list, go to osquery on the Response Scripts tab of Response Management. Click Add query to specify the operating system, type a new query, and validate the query syntax. Choose Input a query: Type a query and click Validate query. Tip Use Companion to generate osquery queries by clicking Generate osquery Query (). Specify a Description for the response or event. Click Create. In the Multi-factor authentication (MFA) required window, paste the verification code and click Submit. If authentication succeeds, the task appears in the Response Management Task List. Tip For response tasks created from the context menu in XDR Data Explorer, click the View details in Forensics icon () in the Response Management Task List to go directly to Forensics → Query Results. Monitor the task status. In the workspace that has the endpoints you are triaging, click View Query Results Select osquery. Locate the task using the Task name menu. View the task status. In progress (): Trend Vision One sent the command and is waiting for a response. Queued (): The managing server queued the command because the agent was offline. Successful (): The command was successfully executed. Unsuccessful (): An error or time-out occurred when attempting to send the command to the managing server, the agent is offline for more than 24 hours, or the command execution timed out. If the task is successful, click the icon to open the Download File window, copy and retain the password, and click Download to obtain the task archive file. © 2025 Trend Micro Incorporated. All rights reserved.Search Knowledge Base