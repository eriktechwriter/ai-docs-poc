---
id: set-up-intrusion-prevention
title: Set up Intrusion Prevention
sidebar_label: Set up Intrusion Prevention
description: Set up Intrusion Prevention
tags:
  - endpoint-security
  - trend-vision-one
---

 Set up Intrusion Prevention Enable Intrusion Prevention and monitor network traffic for exploits using Detect mode. When you are satisfied with how your Intrusion Prevention rules are assigned, switch to Prevent mode. Note The configuration of your intrusion prevention system (IPS) affects system resources like central processing unit (CPU) and random access memory (RAM). To optimize IPS performance on the agent, see Performance tips for Intrusion Prevention. For an overview of Intrusion Prevention, see Block exploit attempts using Intrusion Prevention. Enable Intrusion Prevention in Detect mode Enable Intrusion Prevention and use Detect mode for monitoring. Configure Intrusion Prevention using the appropriate policies to affect the targeted computers. You can also configure individual computers. For more fine-grained control when you assign Intrusion Prevention rules, you can override the global behavior mode and configure specific rules to either prevent or detect. See Override the behavior mode for a rule. Procedure Go to Computer or Policy editor → Intrusion Prevention → General. For Configuration, select one of the following: On Inherited (On) (See policies, inheritance, and overrides.) Select Detect for Intrusion Prevention Behavior. For information on enabling Intrusion Prevention for containers, see Apply your intrusion prevention settings. If the behavior settings are not available, Network Engine Mode may be set to Tap. (See Test Firewall rules before deploying them.) Click Save. Enable Auto Apply core Endpoint & Workload rules Server & Workload Protection assigns core Endpoint & Workload rules to this computer whenever Rule updates happen. However, any manually unassigned rules remain unassigned. Trend Micro recommends that you enable this feature when you have the Endpoint license but disable this feature and use Recommendation scans with the Workload license. Procedure Select Yes for Implement core Endpoint & Workload rules automatically. Click Save. Test Intrusion Prevention Verify that Intrusion Prevention is working properly before continuing with further actions. Procedure If you have an agent-based deployment, ensure you have a computer that has an agent running. Turn off Web Reputation to prevent it from interfering with Intrusion Prevention. In the Server & Workload Protection console, click Computers. Double-click the computer where you plan to test Intrusion Prevention. Click Web Reputation. Select Off Block bad traffic: Click Intrusion Prevention for the computer. On the General tab, select Prevent. If Prevent is unavailable, set Configuration to Inherited (On). Assign the European Institute for Computer Antivirus Research (EICAR) test policy: Click Intrusion Prevention for the computer. Click Assign/Unassign. Search for 1005924. Select 1005924 - Restrict Download of EICAR Test File Over HTTP. Click OK. Try to download the EICAR file. Intrusion Prevention should stop you from downloading this file. On Windows, go to http://files.trendmicro.com/products/eicar-file/eicar.com. On Linux, enter this command: curl -O http://files.trendmicro.com/products/eicar-file/eicar.com Review the Intrusion Prevention events for the computer: Select Intrusion Prevention → Intrusion Prevention Events for the computer. Click Get Events to see events that have occurred since the last heartbeat. Look for an event with 1005924 - Restrict Download of EICAR Test File Over HTTP as the Reason. The presence of this event indicates that Intrusion Prevention is working. Revert your changes to return your system to its previous state: Turn on Web Reputation. Reset the Prevent or Detect option. Remove the EICAR policy from the computer. Apply recommended rules To maximize performance, only assign the Intrusion Prevention rules that your policies and computers require. Use a recommendation scan to obtain a list of rules that are appropriate. Although recommendation scans are performed for a specific computer, you can assign the recommendations to a policy that the computer uses. You can also configure Server & Workload Protection to Automatically implement recommendations scan results. Procedure Open the properties for the computer. On the General tab under Recommendations, click Scan for Recommendations. The results of the latest enhanced recommendation scan appear on the General tab of the Intrusion Prevention, Integrity Monitoring, or Log Inspection protection module. Open the policy that you want to assign the rules to and complete the rule assignments (see Manually assign rules). Next steps After you apply Intrusion Prevention rules, monitor system performance and Intrusion Prevention event logs. Monitor CPU, RAM, and network usage to verify that system performance is still acceptable. If not, you can modify some settings and deployment aspects to improve performance. (See Performance tips for Intrusion Prevention.) Check Intrusion Prevention events Monitor Intrusion Prevention events to ensure that rules are not matching legitimate network traffic. If a rule is causing false positives you can unassign the rule. (See Assign and unassign rules.) Procedure To see Intrusion Prevention events, click Events & Reports → Intrusion Prevention Events. Enable fail open for packet or system failures Intrusion Prevention includes a network engine that may block packets before Intrusion Prevention rules can be applied. This could lead to performance issues. You can change this behavior to allow packets when system or internal packet failures occur. For details, see Enable fail open behavior. Switch to Prevent mode When you are satisfied that Intrusion Prevention is not finding false positives, configure your policy to use Intrusion Prevention in Prevent mode to enforce rules and log related events. Procedure Go to Computer or Policy editor → Intrusion Prevention → General. Select Prevent for Intrusion Prevention Behavior. Click Save. HTTP Protocol Decoding rule The HTTP Protocol Decoding rule is the most important rule in the Web Server Common Application Type. This rule decodes the HTTP traffic before the other rules inspect it. This rule also allows you to control various components of the decoding process. This rule is required when you use any of the Web Application Common or Web Server Common rules that require it. Server & Workload Protection automatically assigns this rule when it is required by other rules. Because each web application is different, the policy that uses this rule should run in Detect mode for a period of time before switching to Prevent mode to determine if any configuration changes are required. Quite often, changes are required to the list of illegal characters. Refer to the Knowledge Base for details on how to tune this rule. Cross-site scripting and generic SQL injection rules Two of the most common application-layer attacks are SQL injection and cross-site scripting (XSS). Cross-site scripting and SQL injection rules intercept the majority of attacks by default, but you may need to adjust the drop score for specific resources if they cause false positives. Both rules are smart filters that need custom configuration for web servers. If you have output from a Web Application Vulnerability Scanner, you should leverage that information when applying protection. For example, if the user name field on the login.asp page is vulnerable to SQL injection, ensure that the SQL injection rule is configured to monitor that parameter with a low threshold to drop on. For more information, see https://success.trendmicro.com/en-us/solution/ka-0003649 © 2025 Trend Micro Incorporated. All rights reserved.Search Knowledge Base