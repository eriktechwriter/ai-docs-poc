---
id: artifact-scanner-cli
title: Artifact Scanner CLI
sidebar_label: Artifact Scanner CLI
description: Artifact Scanner CLI
tags:
  - endpoint-security
  - trend-vision-one
---

/*<![CDATA[*/ $('#title').html($('meta[name=map-description]').attr('content')); /*]]>*/ Artifact Scanner CLI General usage Available commands Global flags Scan command usage Scan command flags Supported artifacts Scan subcommands Vulnerabilities subcommand Malware subcommand Secrets subcommand Proxy configuration General usage For examples of commands using Trend Micro Artifact Scanner (TMAS), see Examples. tmas [command] [flags] Available commands Command Description scan Scan an artifact with any combination of scanners (at least one of vulnerabilities, malware, or secrets). version Get current CLI version (long). help Display help information. Global flags Flag Description --version Get current CLI version (short). -v, --verbose Increase verbosity (-v = info, -vv = debug). -h, --help Display help information. Scan command usage tmas scan [artifact] [flags] Scan command flags Flag Description -p, --platform Specify platform for multi-platform container image sources. For example: linux/arm64, linux/arm64/v8, arm64, linux. Default is linux/amd64. -r, --region Trend Vision One service regions: ap-southeast-2, eu-central-1, ap-south-1, ap-northeast-1, ap-southeast-1, us-east-1, me-central-1. Default is us-east-1. -V, --vulnerabilities Enable scanning for vulnerabilities (optional). -M, --malware Enable scanning for malware (optional). Supports docker, docker-archive, oci-archive, oci-dir and registry artifact types. -S, --secrets Enable scanning for secrets (optional). -o, --override Specify the file path to the file containing the vulnerability and secret override rules (optional). For example: /path/to/tmas_overrides.yml. --saveSBOM Save SBOM in the local directory (optional). --distro Specify the distribution to match vulnerabilities against file and directory artifacts (optional). Use the formation <distro>:<version>, like ol:8.4, for example. --evaluatePolicy Important This is a "Pre-release" feature and is not considered an official release. Please review the Pre-release disclaimer before using the feature. For Code Security, you can preview the policy evaluation functionality using the --evaluatePolicy flag. Evaluate the scan results against your Code Security policy. A default policy is provided for all accounts, or you can customize it in the Trend Vision One console. TMAS returns the results and exits with status code 2 if the policy is violated. Learn more about Code Security policies. -v, --verbose Increase verbosity (-v = info, -vv = debug). -h, --help Display help information. Note For more information on available scanners and their flags, see Scan subcommands. Using a scanner-specific flag without enabling the associated scanner does not result in an error, but that flag will have no effect. Supported artifacts Artifact Description docker:yourrepo/yourimage:tag Use images from the Docker daemon. podman:yourrepo/yourimage:tag Use images from the Podman daemon. docker-archive:path/to/yourimage.tar Use a tarball from disk for archives created from docker save. oci-archive:path/to/yourimage.tar Use a tarball from disk for OCI archives (from Skopeo or otherwise). oci-dir:path/to/yourimage Read directly from a path on disk for OCI layout directories (from Skopeo or otherwise). singularity:path/to/yourimage.sif Read directly from a Singularity Image Format (SIF) container on disk. registry:yourrepo/yourimage:tag Pull image directly from a registry (no container runtime required). dir:path/to/yourproject Read directly from a path on disk (any directory). file:path/to/yourproject/file Read directly from a path on disk (any single file). Scan subcommands tmas scan [subcommand] [artifact] [flags] Subcommand Description vulnerabilities Perform a vulnerability scan on an artifact. malware Perform a malware scan on an image artifact. secrets Perform a secrets scan on an artifact. Vulnerabilities subcommand tmas scan vulnerabilities <artifact_to_scan> Flag Description -p, --platform Specify platform for multi-platform container image sources. For example: linux/arm64, linux/arm64/v8, arm64, linux. Default is linux/amd64. -r, --region Trend Vision One service regions: ap-southeast-2, eu-central-1, ap-south-1, ap-northeast-1, ap-southeast-1, us-east-1, me-central-1 Default is us-east-1. -o, --override Specify the file path to the file containing the vulnerability override rules (optional). For example: /path/to/tmas_overrides.yml. --saveSBOM Save SBOM in the local directory (optional). --distro Specify the distribution to match vulnerabilities against file and directory artifacts (optional). Use the formation <distro>:<version>, like ol:8.4, for example. --evaluatePolicy Important This is a "Pre-release" feature and is not considered an official release. Please review the Pre-release disclaimer before using the feature. For Code Security, you can preview the policy evaluation functionality using the --evaluatePolicy flag. Evaluate the scan results against your Code Security policy. A default policy is provided for all accounts, or you can customize it in the Trend Vision One console. TMAS returns the results and exits with status code 2 if the policy is violated. Learn more about Code Security policies. -v, --verbose Increase verbosity (-v = info, -vv = debug). -h, --help Display help information. Note Vulnerability scans are limited to artifacts for which the generated SBOM data is less than 15 MB. Malware subcommand tmas scan malware <artifact_to_scan> Flag Description -p, --platform Specify platform for multi-platform container image sources. For example: linux/arm64, linux/arm64/v8, arm64, linux. Default is linux/amd64. -r, --region Trend Vision One service regions: ap-southeast-2, eu-central-1, ap-south-1, ap-northeast-1, ap-southeast-1, us-east-1, me-central-1. Default is us-east-1. --evaluatePolicy Important This is a "Pre-release" feature and is not considered an official release. Please review the Pre-release disclaimer before using the feature. For Code Security, you can preview the policy evaluation functionality using the --evaluatePolicy flag. Evaluate the scan results against your Code Security policy. A default policy is provided for all accounts, or you can customize it in the Trend Vision One console. TMAS returns the results and exits with status code 2 if the policy is violated. Learn more about Code Security policies. -v, --verbose Increase verbosity (-v = info, -vv = debug). -h, --help Display help information. Note Malware scans only support docker, docker-archive, oci-archive, oci-dir and registry artifact types. The maximum single file size limit is 1 GB. The scan skips files larger than 1 GB. The maximum single layer size limit is 512 MB. The scan skips layers larger than 512 MB. Secrets subcommand tmas scan secrets <artifact_to_scan> Flag Description -p, --platform Specify platform for multi-platform container image sources. For example: linux/arm64, linux/arm64/v8, arm64, linux. Default is linux/amd64. -r, --region Trend Vision One service regions: ap-southeast-2, eu-central-1, ap-south-1, ap-northeast-1, ap-southeast-1, us-east-1, me-central-1. Default is us-east-1. -r, --override Specify the file path to the file containing the secret override rules (optional). For example: /path/to/tmas_overrides.yml. -v, --verbose Increase verbosity (-v = info, -vv = debug). --evaluatePolicy Important This is a "Pre-release" feature and is not considered an official release. Please review the Pre-release disclaimer before using the feature. For Code Security, you can preview the policy evaluation functionality using the --evaluatePolicy flag. Evaluate the scan results against your Code Security policy. A default policy is provided for all accounts, or you can customize it in the Trend Vision One console. TMAS returns the results and exits with status code 2 if the policy is violated. Learn more about Code Security policies. --redacted Important This is a "Pre-release" feature and is not considered an official release. Please review the Pre-release disclaimer before using the feature. Redact secret finding values from the TMAS CLI output. Usage example: tmas scan <artifact-to-scan> -S --redacted tmas scan secrets <artifact-to-scan> --redacted -h, --help Display help information. Note Secret scans are limited to artifacts that generate secret findings reports that are smaller than 15 MB. Binary and ZIP files are not currently supported. Secret scan findings are redacted prior to being sent to Trend Vision One for further processing. Proxy configuration The CLI tool loads the proxy configuration from the following set of optional environment variables: Environment Variable Required/Optional Description NO_PROXY Optional Add the Artifact Scanning as a Service and Malware Scanning as a Service endpoints to the comma-separated list of host names if you want to skip proxy settings for the CLI tool. Note Only an asterisk (*) matches all hosts. HTTP_PROXY Optional http://proxy.example.com HTTPS_PROXY Optional https://proxy.example.com If the proxy server is a SOCKS5 proxy, you must specify the SOCKS5 protocol in the URL as socks5://socks_proxy.example.com. PROXY_USER Optional Optional username for authentication header used in Proxy-Authorization. PROXY_PASS Optional Optional password for authentication header used in Proxy-Authorization used only when a PROXY_USER is configured. Â© 2025 Trend Micro Incorporated. All rights reserved.Search Knowledge Base