---
slug: trend-vision-one-run-yara-rules-task
title: Run YARA rules task
last_updated: '2025-09-08'
ai_context:
  source_file: run-yara-rules-task.md
  conversion_date: '2025-09-08T23:42:13.372Z'
conversion_status: converted
translation_ready: true
---

:::: {role="main"}
Run custom YARA rules on the specified endpoints to support threat investigation and incident response.

:::warning[Important]

The following services support this task:

- Trend Vision One

  - Windows agent

  - Linux agent
:::

After [creating a workspace and adding endpoints to the workspace](workspaces.mdx) in the **Forensics** app, you can collect detailed evidence from potentially compromised endpoints for internal investigations into critical incidents that occurred on your network and may require further attention.

### Procedure {#procedure}

1.  In the Trend Vision One console, go to **Agentic SIEM & XDR → Forensics**.

2.  Click the name of the workspace that has the endpoints you want to triage.

3.  Select one or more endpoints from the list. Selected endpoints must all use the same operating system.

4.  Click **Run YARA Rules**.

    :::note

    You can also perform this response from the [context menu](context-menu.mdx) in **XDR Data Explorer**, Workbench, and Observed Attack Techniques.
    :::

5.  Configure the task.

    1.  Use the radio buttons either to select existing YARA rules or to upload new rules.

        - Choose **Select rules**:

          1.  Click **Select YARA rules**.

          2.  Pause on a file to view its details.

              :::warning[Important]

              YARA rules details are only visible for ![TLP:GREEN](/images/tlp-green=ff659a82-dd4b-427d-9a1c-215afb843a94.webp) and ![TLP:CLEAR](/images/tlp-clear=29e7b79a-3e6f-4a7e-bf82-ecd9e8113efd.webp). See [Traffic Light Protocol (TLP)](https://www.first.org/tlp/) for details.
              :::

          3.  Select the rules.

          4.  Click **Continue**.

          To add new YARA rules to the list:

          1.  Go to **YARA Rules** on the **Response Scripts** tab of Response Management.
          2.  Click **Add YARA rules** to upload a file and validate the rules' syntax.

        - Choose **Upload rules**:

          1.  Click **Upload file**.
          2.  Select a file that is in YARA or TXT format and is less than 1 MB in size.

          :::tip

          Use [Companion](companion.mdx) to generate YARA rules by clicking **Generate YARA Rules** (![](/images/companion_icon=ebfb1301-169d-4687-b329-7c6b4e235192.webp)).
          :::

    2.  Select the target type and specify related settings:

        - For **Process** targets, specify a **Process name**. If you do not specify a process name, **Forensics** scans all processes. Scanning all processes might take several minutes to complete.

        - For **File** targets:

          1.  Specify the **File location**.

          2.  Select a **File size**.

          3.  Select a **Scan setting**.

              :::warning[Important]

              Selecting **Scan all files and subfolders** might cause performance issues.
              :::

    3.  Validate your YARA rules by clicking **Validate YARA rules**.

    4.  Specify a **Description** for the response or event.

    5.  Click **Create**.

    6.  Paste the verification code in **Multi-factor authentication (MFA) required** and click **Submit**.

        If authentication succeeds, the task appears in the **Response Management** **Task List**.

        :::tip

        For response tasks created from the [context menu](context-menu.mdx) in **XDR Data Explorer**, click the **View details in Forensics** icon (![](/images/export_icon=GUID-88c87c83-f1e1-465e-9d60-9ba4a60f6849.webp)) in the **Response Management** **Task List** to go directly to **Forensics → Query Results**.
        :::

6.  Monitor the task status.

    1.  In the workspace that has the endpoints you are triaging, click **View Query Results**

    2.  Select **YARA**.

    3.  Locate the task using the **Task name** menu.

    4.  View the task status.

        - **In progress** (![](/images/in_progress=GUID-A55897DB-3DEA-4F5C-B7F9-70B3D7FB9EDE=1=en-us=Low.webp)): Trend Vision One sent the command and is waiting for a response.

        - **Queued** (![](/images/queued=GUID-65C0DF81-E50D-4D51-9602-2E9B7A0E5F14=1=en-us=Low.webp)): The managing server queued the command because the agent was offline.

        - **Successful** (![](/images/successful=GUID-1E31AD86-DE2E-48B5-85F7-7C78A3E8BB11=1=en-us=Low.webp)): The command was successfully executed.

        - **Unsuccessful** (![](/images/error=5cc21722-7ceb-480c-b9c2-a47d420cf1cc.webp)): An error or time-out occurred when attempting to send the command to the managing server, the agent is offline for more than 24 hours, or the command execution timed out.

    5.  If the task is successful:

        1.  Click the ![](/images/download_icon=5c7476c2-cf15-4572-b7cd-5fc67a57d22f.webp) icon to open the **Download File** window.

        2.  Copy and retain the password.

        3.  Click **Download** to obtain the task archive file.
::::
