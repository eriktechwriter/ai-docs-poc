---
slug: trend-vision-one-template-scanner
title: Trend Vision One™ Cloud Risk Management - Template Scanner
last_updated: '2025-09-08'
ai_context:
  source_file: template-scanner.md
  conversion_date: '2025-09-08T23:42:12.085Z'
conversion_status: converted
translation_ready: true
---

::: {role="main"}

<table>
<colgroup>
<col style="width: 25%" />
<col style="width: 75%" />
</colgroup>
<tbody>
<tr>
<td>Location</td>
<td><strong>Top navigation bar &gt; Template Scanner</strong></td>
</tr>
</tbody>
</table>

Template Scanner enables you to run Trend Vision One™ – Cloud Risk Management [Rules](https://docs.trendmicro.com/en-us/documentation/article/trend-vision-one-introduction-rules) on your [Terraform](https://aws.amazon.com/blogs/apn/using-terraform-to-manage-aws-programmable-infrastructures/), [AWS Cloud Development Kit (CDK)](https://aws.amazon.com/cdk/), [Serverless Framework](https://www.serverless.com/framework/docs), and [AWS CloudFormation](https://docs.aws.amazon.com/cloudformation/index.mdx) templates. You can add preventative security and governance controls to the workflow to identify and remediate issues prior to launching any services and resources.

- What is Template Scanner?
- Supported features
- Scan via UI
  - Scanning a CloudFormation template
  - Scanning AWS Cloud Development Kit (CDK)
  - Scanning Serverless Framework
  - Scanning Terraform
- Scan via API
- Supported Rules
- Why do I not see any scan results?

### What is Template Scanner? {#what-is-template-scanner}

Template Scanner provides a preventative measure to ensure your AWS infrastructure remains compliant by detecting risks in your Infrastructure as Code (IaC) before it's deployed.

You can use this service to scan Cloudformation templates and terraform configuration files.

### Supported features {#supported-features}

To scan your IaC files, you can use one or a combination of the following:

- Using the application UI to upload templates
- Using the API to post requests with templates

<table>
<thead>
<tr>
<th><p>Feature</p></th>
<th><p>Template Scanner UI/API</p></th>
</tr>
</thead>
<tbody>
<tr>
<td><p>Graphical interface to load files</p></td>
<td><p>✅</p></td>
</tr>
<tr>
<td><p>Public API</p></td>
<td><p>✅</p></td>
</tr>
<tr>
<td><p>Account and Profile Rule settings</p></td>
<td><p>✅</p></td>
</tr>
<tr>
<td><p>Github Integration</p></td>
<td><p>❌</p></td>
</tr>
<tr>
<td><p>AWS CloudFormation</p></td>
<td><p>✅</p></td>
</tr>
<tr>
<td><p>AWS Cloud Development Kit (CDK)</p></td>
<td><p>✅</p></td>
</tr>
<tr>
<td><p>Serverless Framework (AWS)</p></td>
<td><p>✅</p></td>
</tr>
<tr>
<td><p>Terraform (AWS, Azure and GCP)*New</p></td>
<td><p>✅</p>
<p>Supported through Terraform Plan files (<code>.json</code>) and HCL templates (<code>.tf</code>)</p></td>
</tr>
</tbody>
</table>

### Scan via UI {#scan-via-ui}

1.  Select the type of rule settings you want to scan for:
    - *Default rule settings*: upload and scan using rule settings from your organization.
    - *Profile rule settings*: upload and scan using rule settings from a selected profile.
    - *Account rule settings*: upload and scan using rule settings from a selected account.

### Scanning a CloudFormation template {#scanning-a-cloudformation-template}

- CloudFormation templates can be uploaded in either JSON or YAML format.
- You can also use the ! Condition in YAML templates.

### Scanning AWS Cloud Development Kit (CDK) {#scanning-aws-cloud-development-kit-cdk}

Template scanner supports the evaluation of your CDK files by synthesizing a Cloudformation template out of the CDK code.

1.  Install the [AWS CDK CLI](https://docs.aws.amazon.com/cdk/v2/guide/getting_started.mdx)
2.  In the directory with your CDK code, run `cdk synth`. This will output a YAML CloudFormation file (can also use `--json` if desired).
3.  Use Template Scanner UI or API endpoints to scan the CloudFormation file generated by `cdk synth`.

### Scanning Serverless Framework {#scanning-serverless-framework}

Template scanner supports the evaluation of your Serverless Framework applications by synthesizing a Cloudformation template out of the serverless code.

1.  In the directory with your `serverless` file, run `serverless package` to generate a JSON file in ` .serverless/cloudformation-template-update-stack.json`.
2.  Use Template Scanner UI or API endpoints to scan the CloudFormation file generated by `serverless package`.

### Scanning Terraform Plans {#scanning-terraform-plans}

1.  Terraform templates must be converted to a Terraform plan in JSON by following the steps below from your Command Line tool:

    1.  In the same directory as .tf template, export your provider's *access key*, *secret key,* and *export region* (e.g. \`export AWS_REGION=us-east-1\`)
    2.  Run the command `terraform init`
    3.  Run the command `terraform plan -out=your_file`
    4.  Run the command `terraform show -json your_file > your_file.json`. Your Terraform JSON plan is ready to be uploaded to the Template Scanner from the same folder as your .tf file.

2.  Click on *Upload and scan* to view scan results for your selected rule settings.

3.  You will get a message for missing parameters while scanning your template. Decide whether you want to *Proceed* or *Cancel* the scanning process.

    :::note

    Resources with missing parameters will not be scanned and thereby result in partial scan results.
    :::

4.  Review [Checks](https://docs.trendmicro.com/en-us/documentation/article/trend-vision-one-model-check) from scan results. Failed checks will display a [Resolve](https://docs.trendmicro.com/en-us/documentation/article/trend-vision-one-failed-check-resolution) button with a link to resolution steps. For more information on the anatomy of the rule, see [Rules](https://docs.trendmicro.com/en-us/documentation/article/trend-vision-one-introduction-rules).

    :::note

    Resolution steps provided with failed checks are for workflows via CLI or Console. You can also use these steps as a guide for resolution within CloudFormation.
    :::

### Scanning Terraform HCL templates {#scanning-terraform-hcl-templates}

1.  Create a ZIP file containing your .tf files
2.  Click on the **Template Scanner** menu
3.  Click on the **Terraform** tab
4.  Browse your ZIP file
5.  Click Upload and scan

### Scan via API {#scan-via-api}

See [API reference](https://automation.trendmicro.com/xdr/api-beta/) for how to use Template Scanner API in your automation or build pipelines.

Additional examples can be found below:

- [AWS Cloud Formation Example](https://docs.trendmicro.com/en-us/documentation/article/trend-vision-one-aws-cloudformation-example)

- [AWS CDK Example](https://docs.trendmicro.com/en-us/documentation/article/trend-vision-one-aws-cdk-development-kit-cdk-example)

- [Terraform Plan](https://docs.trendmicro.com/en-us/documentation/article/trend-vision-one-terraform-aws-example)

- [Serverless-framework-aws example](https://docs.trendmicro.com/en-us/documentation/article/trend-vision-one-serverless-framework-aws-example)

- [Terraform HCL](https://docs.trendmicro.com/en-us/documentation/article/trend-vision-one-terraform-hcl-aws-example)

### Supported rules {#supported-rules}

The following API endpoints can be used to retrieve a list of rules supported by Template Scanner:

- [CloudFormation Template](https://us-west-2-api.cloudconformity.com/v1/template-scanner/rules?type=cloudformation-template)

<!-- -->

- [Terraform](https://us-west-2-api.cloudconformity.com/v1/template-scanner/rules?type=terraform-template)

Please refer to this [page](https://docs.trendmicro.com/en-us/documentation/article/trend-vision-one-template-scanner-coverage-V1) for an overview of the supported resources.

### Why do I not see any scan results? {#why-do-i-not-see-any-scan-results}

You may receive an empty response or an error for any of the following reasons:

1.  Unsupported resource type or rules - Template Scanner only supports resource-level rules. Please refer to the APIs for a list of [supported rules and resource types](https://docs.trendmicro.com/en-us/documentation/article/trend-vision-one-template-scanner-coverage-V1). We have plans to add support for more source types over time. If there is a specific resource type you need as a priority, please contact your account manager.
2.  Parameter(s) with no default value - CloudFormation templates with parameters that have no default values may fail to be processed.
3.  Unsupported AWS CloudFormation intrinsic functions - CloudFormation templates with unsupported intrinsic functions may not process or may not generate complete results. The following are the *supported* intrinsic functions in CloudFormation templates:
    - Fn::Base64
    - Fn::And
    - Fn::Equals
    - Fn::If
    - Fn::Not
    - Fn::Or
    - Fn::FindInMap
    - Fn::GetAtt
    - Fn::GetAZs
    - Fn::Join
    - Fn::Select
    - Fn::Split
    - Fn::Sub
    - Ref

You may want to temporarily replace these functions for static values so your template can be correctly scanned.
:::
