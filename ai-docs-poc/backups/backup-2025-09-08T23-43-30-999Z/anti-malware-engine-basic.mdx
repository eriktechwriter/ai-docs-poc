---
slug: trend-vision-one-anti-malware-engine-basic
title: 'Warning: Anti-Malware engine has only basic functions'
last_updated: '2025-09-08'
ai_context:
  source_file: anti-malware-engine-basic.md
  conversion_date: '2025-09-08T23:42:25.185Z'
conversion_status: converted
translation_ready: true
---

::: {role="main"}
When a new Linux kernel version is released, Trend Micro releases a new kernel support package for the agent. If a computer's kernel version is not currently supported, then the Anti-Malware engine can provide only basic protection. Normal protection resumes when the agent receives the update to support the new kernel version. To prevent this problem, verify that the new kernel version is supported before you upgrading.

**Basic functions**

<table>
<colgroup>
<col style="width: 40%" />
<col style="width: 40%" />
<col style="width: 20%" />
</colgroup>
<thead>
<tr>
<th><p>Category</p></th>
<th><p>Feature name</p></th>
<th><p>Supported</p></th>
</tr>
</thead>
<tbody>
<tr>
<td rowspan="8"><p>Scan / Detection</p></td>
<td><p>Document exploit protection</p></td>
<td><p>✔</p></td>
</tr>
<tr>
<td><p>Predictive machine learning (1)</p></td>
<td> </td>
</tr>
<tr>
<td><p>Behavior monitoring</p></td>
<td></td>
</tr>
<tr>
<td><p>Spyware/Grayware</p></td>
<td><p>✔</p></td>
</tr>
<tr>
<td><p>IntelliTrap</p></td>
<td><p>✔</p></td>
</tr>
<tr>
<td><p>Scan compressed file</p></td>
<td><p>✔</p></td>
</tr>
<tr>
<td><p>Smart scan</p></td>
<td><p>✔</p></td>
</tr>
<tr>
<td><p>Connected threat defense</p></td>
<td><p>✔</p></td>
</tr>
<tr>
<td rowspan="7"><p>Inclusion / Exclusion</p></td>
<td><p>Document exploit protection</p></td>
<td><p>✔</p></td>
</tr>
<tr>
<td><p>Directories inclusion</p></td>
<td><p>✔</p></td>
</tr>
<tr>
<td><p>File inclusion</p></td>
<td><p>✔</p></td>
</tr>
<tr>
<td><p>Directories exclusion</p></td>
<td><p>✔</p></td>
</tr>
<tr>
<td><p>File exclusion</p></td>
<td><p>✔</p></td>
</tr>
<tr>
<td><p>File extension exclusion</p></td>
<td><p>✔</p></td>
</tr>
<tr>
<td><p>Process image file exclusion (2)</p></td>
<td><p>✔</p></td>
</tr>
<tr>
<td rowspan="2"><p>Quarantine</p></td>
<td><p>Quarantine file</p></td>
<td><p>✔</p></td>
</tr>
<tr>
<td><p>Restore file</p></td>
<td><p>✔</p></td>
</tr>
<tr>
<td><p>Container</p></td>
<td><p>Container protection (3)</p></td>
<td> </td>
</tr>
</tbody>
</table>

**(1) Predictive machine learning**: Sometimes this might work if the agent can get the process image path, but it is not reliable and therefore not supported.

**(2) Process image file exclusion**: Changes to user-mode matching. Performance could be impacted.

**(3) Container protection**: The agent cannot protect runtime container workloads in this mode.

### Reason IDs {#reason-ids}

If the agent is providing only basic protection and you want to restore full functionality, then you must resolve the cause. Steps vary by reason ID:

- **Reason ID 7**: No driver is available for the particular kernel version causes a driver offline error. To resolve this: Check if latest Kernel Support Package (KSP) is released for that particular kernel. File a case to request KSP support.

- **Reason ID 11**: The Trend Micro public key--on the system when SecureBoot is enabled--is **missing**, so loading the driver failed, which caused a driver offline error. To resolve this: [Install the machine owner key](config-linux-secure-boot-agents.mdx).

- **Reason ID 12**: The Trend Micro public key--on the system when SecureBoot is enabled--is **expired**, so loading the driver failed, which caused a driver offline error. To resolve this: [Install the machine owner key](config-linux-secure-boot-agents.mdx).

- **Other reason IDs**: [Create a diagnostic package](create-diagnostic-package-logs.mdx) and [contact support](https://cloudone.trendmicro.com/support).

The reason ID is included in events forwarded to an external Syslog, SIEM server, or to Amazon SNS. The reason ID is also displayed in the event description for the agent (either Anti-Malware Engine Offline or Anti-Malware Engine with Basic Functions).

<table>
<colgroup>
<col style="width: 14%" />
<col style="width: 28%" />
<col style="width: 56%" />
</colgroup>
<thead>
<tr>
<th><p>Reason ID</p></th>
<th><p>Event reason</p></th>
<th><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr>
<td><p>1</p></td>
<td><p>Unknown reason</p></td>
<td><p>The malware scan failed for an unknown reason.</p></td>
</tr>
<tr>
<td><p>2</p></td>
<td><p>Incomplete Anti-Malware installation</p></td>
<td><p>Incomplete installation of the Anti-Malware service. This causes a driver offline error.</p></td>
</tr>
<tr>
<td><p>3</p></td>
<td><p>Failed process communication between DSA and AM service</p></td>
<td><p>The process communication between the agent and Anti-Malware service failed. This causes a driver offline error.</p></td>
</tr>
<tr>
<td><p>4</p></td>
<td><p>Timeout of restart</p></td>
<td><p>The Anti-Malware service (AMSP) restart timed out. (That is, the code signature verification process has hung.)</p></td>
</tr>
<tr>
<td><p>5</p></td>
<td><p>Stopped Anti-Malware service</p></td>
<td><p>The Anti-Malware service has stopped unexpectedly. This causes a driver offline error.</p></td>
</tr>
<tr>
<td><p>6</p></td>
<td><p>Failed sign check</p></td>
<td><p>Windows file (binaries/DLL) code signature verification failed unexpectedly.</p></td>
</tr>
<tr>
<td><p>7</p></td>
<td><p>Unavailable kernel version</p></td>
<td><p>No driver is available for the Linux kernel version. This causes a driver offline error.</p></td>
</tr>
<tr>
<td><p>8</p></td>
<td><p>Failed driver loading</p></td>
<td><p>Loading the driver (tmhook/bmhook) into the kernel failed. This causes a driver offline error.</p></td>
</tr>
<tr>
<td><p>9</p></td>
<td><p>Failed driver unloading</p></td>
<td><p>Unloading a driver from the kernel failed. This causes a driver offline error.</p>


:::note

<p>Currently, this scenario does not occur, so the agent never reports this code in DsspState on Linux.</p>


:::

</td>
</tr>
<tr>
<td><p>10</p></td>
<td><p>Failed driver device opening</p></td>
<td><p>Opening a driver device file failed. This causes a driver offline error.</p></td>
</tr>
<tr>
<td><p>11</p></td>
<td><p>Missing machine owner key Trend Micro public key</p></td>
<td><p>The Trend Micro public key is missing in the SecureBoot machine owner key (MOK) list on the computer. As a result, the driver signature cannot be verified, and the computer will not load the driver. This causes a driver offline error.</p></td>
</tr>
<tr>
<td><p>12</p></td>
<td><p>Expired machine owner key Trend Micro public key</p></td>
<td><p>The Trend Micro public key is expired in the SecureBook MOK list on the computer. As a result, the driver signature cannot be verified, and the computer will not load the driver. This causes a driver offline error.</p></td>
</tr>
<tr>
<td><p>13</p></td>
<td><p>Signed with unauthorized public key</p></td>
<td><p>The driver was signed with an unknown/unsupported public key.</p></td>
</tr>
<tr>
<td><p>14</p></td>
<td><p>Configuration file disable driver</p></td>
<td><p>Agent is set to not load the driver by configuration ini file. This causes a driver offline state.</p></td>
</tr>
<tr>
<td><p>15</p></td>
<td><p>Policy disable driver</p></td>
<td><p>Agent is set to not load the driver by DSM/C1WS policy. This causes a driver offline state.</p></td>
</tr>
</tbody>
</table>
:::
