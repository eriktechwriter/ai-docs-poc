---
slug: trend-vision-one-cis-eks-313
title: >-
  3.1.3 - Ensure that the kubelet configuration file has permissions set to 644
  or more restrictive (Automated)
last_updated: '2025-09-08'
ai_context:
  source_file: cis-eks-313.md
  conversion_date: '2025-09-08T23:42:23.749Z'
conversion_status: converted
translation_ready: true
---

:::: {role="main"}
Profile applicability: Level 1

Ensure that if the kubelet refers to a configuration file with the `--config` argument, that file has permissions of 644 or more restrictive.

The kubelet reads various parameters, including security settings, from a config file specified by the `--config` argument. If this file is specified you should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system.

:::note

See the AWS EKS documentation for the default value.
:::

### Audit {#audit}

**Method 1**

1.  SSH to the relevant worker nodes.

2.  Enter the following command to check to see if the Kubelet Service is running:

    ``` codeblock
    sudo systemctl status kubelet
    ```

    The output should return `Active: active (running) since..`.

3.  Run the following command on each node to find the appropriate Kubelet config file:

    ``` codeblock
    ps -ef | grep kubelet
    ```

    The output of the above command should return something similar to `--config/etc/kubernetes/kubelet/kubelet-config.json`, which is the location of the Kubelet config file.

4.  Run this command to obtain the Kubelet config file's permissions:

    ``` codeblock
    stat -c %a /etc/kubernetes/kubelet/kubelet-config.json
    ```

5.  Verify that the permissions are 644 or more restrictive.

**Method 2**

Create and Run a Privileged Pod

1.  Run a pod that is privileged enough to access the host's file system. To do this, deploy a pod that uses the hostPath volume to mount the node's file system into the pod.

    An example of a simple pod definition that mounts the root of the host to /host within the pod:

    ``` codeblock
    apiVersion: v1
    kind: Pod
    metadata:
      name: file-check
    spec:
      volumes:
      - name: host-root
        hostPath:
          path: /
          type: Directory
      containers:
      - name: nsenter
        image: busybox
        command: ["sleep", "3600"]
        volumeMounts:
        - name: host-root
          mountPath: /host
        securityContext:
          privileged: true
    ```

2.  Save this to a file (e.g., file-check-pod.yaml) and create the pod:

    ``` codeblock
    kubectl apply -f file-check-pod.yaml
    ```

3.  Once the pod is running, exec into it to check file permissions on the node:

    ``` codeblock
    kubectl exec -it file-check -- sh
    ```

4.  Now you are in a shell inside the pod, but you can access the node's file system through the /host directory and check the permission level of the file:

    ``` codeblock
    ls -l /host/etc/kubernetes/kubelet/kubelet-config.json
    ```

5.  Verify that if a file is specified and it exists, the permissions are 644 or more restrictive.

### Remediation {#remediation}

Run the following command (using the config file location identified in the Audit step):

``` codeblock
chmod 644 /etc/kubernetes/kubelet/kubelet-config.json
```
::::
