[
  {
    "id": "cis-eks-312.md_chunk_0",
    "content": "/*<![CDATA[*/ $('#title').html($('meta[name=map-description]').attr('content')); /*]]>*/ 3.1.2 - Ensure that the kubelet kubeconfig file ownership is set to root:root (Automated) Profile applicability: Level 1 If kubelet is running, ensure that the file ownership of its kubeconfig file is set to root:root. The kubeconfig file for kubelet controls various parameters for the kubelet service in the worker node. You should set its file ownership to maintain the integrity of the file. The file should be owned by root:root. Note See the AWS EKS documentation for the default value. Audit Method 1 SSH to the worker nodes. Enter the following command to check to see if the Kubelet Service is running: sudo systemctl status kubelet The output should return Active: active (running) since...",
    "metadata": {
      "filename": "cis-eks-312.md",
      "filePath": "/Users/erik_olafson/kiro-projects/agentic-docs/agentic-docs-poc/ai-docs-poc/docs/cis-eks-312.md",
      "title": "3.1.2 - Ensure that the kubelet kubeconfig file ownership is set to root:root (Automated)",
      "category": "general",
      "tags": [
        "endpoint-security",
        "trend-vision-one"
      ],
      "lastIndexed": "2025-09-18T23:50:45.839Z",
      "heading": "",
      "chunkType": "partial",
      "chunkIndex": 0
    },
    "embedding": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      106,
      58,
      789
    ]
  },
  {
    "id": "cis-eks-312.md_chunk_1",
    "content": "llowing command on each node to find the appropriate kubeconfig file: ps -ef | grep kubelet The output of the above command should return something similar to --kubeconfig/var/lib/kubelet/kubeconfig, which is the location of the kubeconfig file. Run this command to obtain the kubeconfig file ownership: stat -c %U:%G /var/lib/kubelet/kubeconfig Verify that the ownership is set to root:root. Method 2 Create and Run a Privileged Pod Run a pod that is privileged enough to access the host's file system. To do this, deploy a pod that uses the hostPath volume to mount the node's file system into the pod. An example of a simple pod definition that mounts the root of the host to /host within the pod: apiVersion: v1 kind: Pod metadata: name: file-check spec: volumes: - name: host-root hostPath: path: / type: Directory containers: - name: nsenter image: busybox command: [\"sleep\", \"3600\"] volumeMounts: - name: host-root mountPath: /host securityContext: privileged: true Save this to a file (e.g.,",
    "metadata": {
      "filename": "cis-eks-312.md",
      "filePath": "/Users/erik_olafson/kiro-projects/agentic-docs/agentic-docs-poc/ai-docs-poc/docs/cis-eks-312.md",
      "title": "3.1.2 - Ensure that the kubelet kubeconfig file ownership is set to root:root (Automated)",
      "category": "general",
      "tags": [
        "endpoint-security",
        "trend-vision-one"
      ],
      "lastIndexed": "2025-09-18T23:50:45.839Z",
      "heading": "",
      "chunkType": "partial",
      "chunkIndex": 1
    },
    "embedding": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      2,
      0,
      0,
      1,
      0,
      0,
      0,
      0,
      0,
      0,
      133,
      71,
      999
    ]
  },
  {
    "id": "cis-eks-312.md_chunk_2",
    "content": "file-check-pod.yaml) and create the pod: kubectl apply -f file-check-pod.yaml Once the pod is running, exec into it to check file permissions on the node: kubectl exec -it file-check -- sh Now you are in a shell inside the pod, but you can access the node's file system through the /host directory and check the permission level of the file: ls -l /host/var/lib/kubelet/kubeconfig Verify that the ownership is set to root:root. Remediation Run the below command (based on the file location on your system) on each worker node: chown root:root <proxy kubeconfig file> Â© 2025 Trend Micro Incorporated. All rights reserved.Search Knowledge Base",
    "metadata": {
      "filename": "cis-eks-312.md",
      "filePath": "/Users/erik_olafson/kiro-projects/agentic-docs/agentic-docs-poc/ai-docs-poc/docs/cis-eks-312.md",
      "title": "3.1.2 - Ensure that the kubelet kubeconfig file ownership is set to root:root (Automated)",
      "category": "general",
      "tags": [
        "endpoint-security",
        "trend-vision-one"
      ],
      "lastIndexed": "2025-09-18T23:50:45.839Z",
      "heading": "",
      "chunkType": "partial",
      "chunkIndex": 2
    },
    "embedding": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      2,
      0,
      0,
      1,
      0,
      0,
      0,
      0,
      0,
      0,
      97,
      59,
      641
    ]
  }
]